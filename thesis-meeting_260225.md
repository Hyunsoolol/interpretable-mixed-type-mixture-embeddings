# ì‹œë®¬ë ˆì´ì…˜ ì—°êµ¬ ë³´ê³ ì„œ: Mix-HP-AL ì„±ëŠ¥ ê°œì„  ë° ê²€ì¦

> ## ğŸ’¡ [ìš”ì•½] ì§€ë„êµìˆ˜ë‹˜ ê³µìœ ìš©: Mix-HP-AL ì•Œê³ ë¦¬ì¦˜ êµ¬ì¡° ê°œì„  ë° ì„±ëŠ¥ ê²€ì¦ ê²°ê³¼
> 
> ### 1. í•µì‹¬ ê°œì„  ì‚¬í•­ (Pilot êµ¬ì¡° ì¼ì¹˜í™”)
> * ê¸°ì¡´ ì¼ë°˜ Mix-Lasso ê¸°ë°˜ì˜ Pilot ëŒ€ì‹ , **HP êµ¬ì¡°ê°€ ë°˜ì˜ëœ Mix-HP-L(Adaptive=False)**ì„ Pilotìœ¼ë¡œ ì‚¬ìš©í•˜ì—¬ ê³„ì¸µì  êµ¬ì¡°ë¥¼ ì¼ì¹˜ì‹œì¼°ìŠµë‹ˆë‹¤.
> * ì´ë¥¼ í†µí•´ ì‚°ì¶œëœ ê°€ì¤‘ì¹˜ë¡œ Adaptive Penaltyë¥¼ ë¶€ì—¬í•˜ê³ , ì–‘ì§ˆì˜ ì´ˆê¸°ê°’(Warm Start)ì„ ë³¸ í•™ìŠµì— ì ìš©í•˜ì—¬ Local Optima ë¬¸ì œë¥¼ ë°©ì§€í–ˆìŠµë‹ˆë‹¤.
> 
> ### 2. ì£¼ìš” ì‹œë®¬ë ˆì´ì…˜ ê²°ê³¼ (Robust Setting ê²€ì¦)
> ë°˜ë³µ íšŸìˆ˜ì™€ ì´ˆê¸° íƒìƒ‰ì„ í™•ëŒ€í•œ ê²°ê³¼, **Mix-HP-ALì´ ì¢…í•©ì ìœ¼ë¡œ ê°€ì¥ ìš°ìˆ˜í•œ ì„±ëŠ¥**ì„ ë³´ì˜€ìŠµë‹ˆë‹¤.
> * **ì™„ë²½í•œ ëª¨ë¸ ì„ íƒ:** íƒ€ ëª¨ë¸(Mix-AL, Mix-HP-L)ë„ ì •ë‹µ($m=3$)ì„ ì°¾ì•˜ìœ¼ë‚˜, `Mix-HP-AL`ì´ **ê°€ì¥ ë‚®ì€ BIC(743.58)**ë¥¼ ê¸°ë¡í•˜ë©° ìµœì ì˜ ì í•©ë„ë¥¼ ë³´ì˜€ìŠµë‹ˆë‹¤.
> * **ì••ë„ì ì¸ êµ¬ì¡°ì  ì‹ë³„ë ¥(FHR):** `Mix-HP-AL`ì˜ FHRì´ **11.90%**ë¡œ ëª¨ë“  ëª¨ë¸ ì¤‘ ê°€ì¥ ë‚®ì•„, ë¶ˆí•„ìš”í•œ ì°¨ì´í•­($\gamma$)ì„ ê°€ì¥ ì™„ë²½í•˜ê²Œ ì¶•ì†Œì‹œì¼°ìŠµë‹ˆë‹¤.
> * **ìˆ˜ë ´ íš¨ìœ¨ì„± ê·¹ëŒ€í™”:** Warm Start íš¨ê³¼ë¡œ ì¸í•´ íƒ€ ëª¨ë¸(136~149íšŒ) ëŒ€ë¹„ **ê°€ì¥ ì ì€ EM ë°˜ë³µ íšŸìˆ˜(109.7íšŒ)** ë§Œì— ë¹ ë¥´ê²Œ ìˆ˜ë ´í•˜ì˜€ìŠµë‹ˆë‹¤.
> 
> **ğŸ“Œ ê²°ë¡ :** Pilot Estimatorì˜ ê³„ì¸µì  êµ¬ì¡°ë¥¼ ì¼ì¹˜ì‹œí‚¨ ê²°ê³¼, `Mix-HP-AL`ì€ ë¶ˆí•„ìš”í•œ ë³€ìˆ˜ë¥¼ íš¨ê³¼ì ìœ¼ë¡œ í†µì œí•˜ë©´ì„œë„ ë°ì´í„° ì„¤ëª…ë ¥ê³¼ ì—°ì‚° íš¨ìœ¨ì„±ì„ ëª¨ë‘ ë‹¬ì„±í•˜ëŠ” ìµœì ì˜ ëª¨ë¸ì„ì´ í™•ì¸ë˜ì—ˆìŠµë‹ˆë‹¤. ìƒì„¸ ì§€í‘œëŠ” ì•„ë˜ ë³¸ë¬¸ì— ì •ë¦¬í•´ ë‘ì—ˆìŠµë‹ˆë‹¤.
> 
## 1. ê°œìš” (Overview)

ë³¸ ë³´ê³ ì„œëŠ” ê³„ì¸µì  í˜ë„í‹°ê°€ ì ìš©ëœ Adaptive Lasso (**Mix-HP-AL**) ëª¨ë¸ì˜ ì„±ëŠ¥ ì €í•˜ ì›ì¸ì„ ë¶„ì„í•˜ê³ , ì•Œê³ ë¦¬ì¦˜ ìˆ˜ì •ì„ í†µí•´ ì´ë¥¼ ê°œì„ í•œ ê²°ê³¼ë¥¼ ê¸°ìˆ í•œë‹¤. íŠ¹íˆ, **Pilot Estimator(ì˜ˆë¹„ ì¶”ì •ëŸ‰)** ì‚°ì¶œ ë°©ì‹ì˜ êµ¬ì¡°ì  ë¬¸ì œë¥¼ í•´ê²°í•¨ìœ¼ë¡œì¨, ëª¨ë¸ì˜ ì •í™•ë„(MSE)ì™€ êµ¬ì¡°ì  ì‹ë³„ ëŠ¥ë ¥(FHR)ì´ íšê¸°ì ìœ¼ë¡œ í–¥ìƒë¨ì„ í™•ì¸í•˜ì˜€ë‹¤.

---

## 2. ê¸°ì¡´ ë¬¸ì œì  ë° ë¶„ì„ (Before Correction)

### 2.1. ì„¤ì • (High Precision Setting)

ê¸°ì¡´ ì•Œê³ ë¦¬ì¦˜ì˜ ì„±ëŠ¥ì„ í™•ì¸í•˜ê¸° ìœ„í•´, ê³„ì‚° ë¹„ìš©ì„ ë†’ì¸ ì •ë°€ ì„¤ì •ì—ì„œë„ í…ŒìŠ¤íŠ¸ë¥¼ ìˆ˜í–‰í–ˆìœ¼ë‚˜ ë§Œì¡±ìŠ¤ëŸ½ì§€ ëª»í•œ ê²°ê³¼ë¥¼ ë³´ì˜€ë‹¤.

- **Parameters:** $R=10, n=200, p=60, \text{SNR}=50$
    
- **Settings:** `pilot_em=100`, `n_start=20`, `nlambda=50` (ë§¤ìš° ì •ë°€í•œ íƒìƒ‰)
    

### 2.2. ê²°ê³¼ ìš”ì•½ (Baseline Results)

|**Method**|**MSE (Î²)**|**FPR (%)**|**FHR (%)**|**TPR (%)**|**Chosen m (Mode)**|
|---|---|---|---|---|---|
|**Mix-L**|0.0596|15.8|48.57|45.0|2 (Fail)|
|**Mix-AL**|0.2556|71.6|88.57|87.0|**3 (Success)**|
|**Mix-HP-L**|**0.0010**|43.0|**2.86**|**100.0**|**3 (Success)**|
|**Mix-HP-AL**|0.2259|72.0|71.43|96.0|**3 (Success)**|

> **ë¶„ì„:** `Mix-HP-AL`ì´ ì§‘ë‹¨ ìˆ˜($m=3$)ëŠ” ì°¾ì•˜ìœ¼ë‚˜, **MSE(0.2259)**ê°€ ë§¤ìš° ë†’ê³  **FHR(71.43%)**ê³¼ **FPR(72.0%)**ì´ ë¹„ì •ìƒì ìœ¼ë¡œ ë†’ìŒ. ì´ëŠ” Adaptive Weightê°€ ë…¸ì´ì¦ˆë¥¼ ì œëŒ€ë¡œ ì œê±°í•˜ì§€ ëª»í•˜ê³  ìˆìŒì„ ì‹œì‚¬í•¨.

---

## 3. ì•Œê³ ë¦¬ì¦˜ ìˆ˜ì • (Methodology Modification)

### 3.1. í•µì‹¬ ì›ì¸: Pilot Estimatorì˜ êµ¬ì¡°ì  ë¶ˆì¼ì¹˜

Adaptive Lassoì˜ ê°€ì¤‘ì¹˜ $w_{jk} = 1 / |\hat{\beta}_{jk}|^\gamma$ë¥¼ ê³„ì‚°í•˜ê¸° ìœ„í•´ ì‚¬ìš©ë˜ëŠ” **Pilot Estimator($\hat{\beta}_{pilot}$)**ê°€ ê³„ì¸µì  êµ¬ì¡°($\beta = \alpha + \gamma$)ë¥¼ ê³ ë ¤í•˜ì§€ ì•Šì€ ì¼ë°˜ì ì¸ Mixture Model(Mix-Ridge/Lasso)ë¡œ ì¶”ì •ë˜ê³  ìˆì—ˆë‹¤. ì´ë¡œ ì¸í•´ ê³µí†µ ë³€ìˆ˜ì˜ ì°¨ì´í•­($\gamma$)ì— ë¶ˆí•„ìš”í•œ ê°€ì¤‘ì¹˜ê°€ ë¶€ì—¬ë˜ì–´ ì„±ëŠ¥ ì €í•˜ë¥¼ ìœ ë°œí•¨.

### 3.2. í•´ê²° ë°©ì•ˆ: êµ¬ì¡°ì  ì¼ì¹˜í™” (Structural Alignment)

Pilot Estimatorë¥¼ êµ¬í•  ë•Œë„ ë³¸ ëª¨í˜•ê³¼ ë™ì¼í•œ **ê³„ì¸µì  êµ¬ì¡°(Hierarchical Structure)**ë¥¼ ê°–ë„ë¡ ë³€ê²½í•˜ì˜€ë‹¤.

- **ìˆ˜ì • í•¨ìˆ˜:** `fit_mix_HP_L_or_AL`
    
- **êµ¬í˜„ ë°©ì‹:** ì¬ê·€ì  í˜¸ì¶œ(Recursive Call)ì„ í†µí•´ `Mix-HP-L` (Adaptive=False)ì˜ ì¶”ì •ì¹˜ë¥¼ Pilotìœ¼ë¡œ ì‚¬ìš©.
    

$$\hat{\beta}_{pilot} \leftarrow \text{Mix-HP-L (non-adaptive)}$$

$$w_{\alpha} = \frac{1}{|\hat{\alpha}_{pilot}|}, \quad w_{\gamma} = \frac{1}{|\hat{\gamma}_{pilot}|}$$

- **íš¨ê³¼:** Pilot ë‹¨ê³„ì—ì„œ ì´ë¯¸ ê³µí†µ/ì´ì§ˆ êµ¬ì¡°ê°€ íŒŒì•…ëœ ê³„ìˆ˜ë¥¼ ê°€ì¤‘ì¹˜ë¡œ ì‚¬ìš©í•˜ë¯€ë¡œ, Adaptive ë‹¨ê³„ì—ì„œ êµ¬ì¡°ì  í¬ì†Œì„±(Structural Sparsity)ì´ ê·¹ëŒ€í™”ë¨.
    

---

## 4. ìˆ˜ì • í›„ ê²°ê³¼ (After Correction)

ìˆ˜ì •ëœ ë¡œì§ì˜ íš¨ìœ¨ì„±ì„ ê²€ì¦í•˜ê¸° ìœ„í•´, ì´ì „ë³´ë‹¤ í›¨ì”¬ **ì—´ì•…í•œ(Fast) í™˜ê²½**ì—ì„œ í…ŒìŠ¤íŠ¸ë¥¼ ìˆ˜í–‰í•˜ì˜€ë‹¤.

### 4.1. ê²€ì¦ íŒŒë¼ë¯¸í„° (Fast Setting)

- **Parameters:** $R=30, n=200, p=60, snr=50$
    
- **Settings:** `pilot_em=50`, `n_start=8`, `max_em=150`
    

Python

```
CFG = dict(
    R=30, n=200, p=60, snr=50, m_set=[2, 3],
    nlambda=16, lam_ratio=1e-4,
    max_em=150, tol_em=1e-4,
    pilot_em=50, n_start=8,   # ì¶©ë¶„í•œ ì´ˆê¸°ê°’ ë° Pilot íƒìƒ‰
    max_cd=600, tol_cd=1e-6, min_cd=10, rebuild_every=5
)
```

### 4.2. ìµœì¢… ì„±ëŠ¥ ë¹„êµ (Final Results)
| **Method**    | **MSE (Î²)** | **FPR (%)** | **FHR (%)** | **TPR (%)** | **Chosen m**    | **BIC (Mean)** |
| ------------- | ----------- | ----------- | ----------- | ----------- | --------------- | -------------- |
| **Mix-L**     | 0.1252      | 31.40       | 64.76       | 62.00       | 2 (Fail)        | 879.11         |
| **Mix-AL**    | 0.2867      | 80.47       | 96.19       | 96.00       | **3 (Success)** | 835.36         |
| **Mix-HP-L**  | **0.0226**  | 50.20       | 17.62       | 96.33       | **3 (Success)** | 766.58         |
| **Mix-HP-AL** | 0.0358      | **44.47**   | **11.90**   | **97.00**   | **3 (Success)** | **743.58**     |


### 4.3. ê²°ê³¼ í•´ì„ (Interpretation)

ì¶©ë¶„í•œ íƒìƒ‰ ê¸°íšŒê°€ ì£¼ì–´ì§„ ì´ë²ˆ ì‹¤í—˜ì—ì„œëŠ” `Mix-AL`ê³¼ `Mix-HP-L` ëª¨ë‘ ì˜¬ë°”ë¥¸ ì§‘ë‹¨ ìˆ˜($m=3$)ë¥¼ ì‹ë³„í•´ ëƒˆìœ¼ë‚˜, ì„¸ë¶€ ì§€í‘œì—ì„œ `Mix-HP-AL`ì˜ ì••ë„ì ì¸ íš¨ìœ¨ì„±ê³¼ êµ¬ì¡° íŒŒì•… ëŠ¥ë ¥ì´ ì…ì¦ë˜ì—ˆë‹¤.

- **ëª¨ë¸ ì í•©ë„ ë° ìˆ˜ë ´ íš¨ìœ¨ì„±:**
    
    - **BIC:** `Mix-HP-AL`ì˜ í‰ê·  BICê°€ **743.58**ë¡œ ê°€ì¥ ë‚®ì•„, ë¶ˆí•„ìš”í•œ ë³€ìˆ˜ë¥¼ íš¨ê³¼ì ìœ¼ë¡œ í†µì œí•˜ë©´ì„œë„ ë°ì´í„° ì„¤ëª…ë ¥ì´ ê°€ì¥ ë›°ì–´ë‚œ(Parsimonious) ëª¨ë¸ì„ì„ ì¦ëª….
        
    - **EM Iterations:** íƒ€ ëª¨ë¸ë“¤ì´ 136~149íšŒì˜ ë°˜ë³µì„ ê±°ì¹œ ë°˜ë©´, `Mix-HP-AL`ì€ í‰ê·  **109.7íšŒ** ë§Œì— ìˆ˜ë ´í•˜ì˜€ë‹¤. êµ¬ì¡°ê°€ ë°˜ì˜ëœ Pilot Estimatorê°€ í›Œë¥­í•œ Warm Startë¥¼ ì œê³µí•˜ì—¬ ì•Œê³ ë¦¬ì¦˜ì˜ ìµœì í™” ê²½ë¡œë¥¼ í¬ê²Œ ë‹¨ì¶•
        
- **êµ¬ì¡°ì  í¬ì†Œì„±(FHR) ë° ë³€ìˆ˜ ì„ íƒ:**
    
    - **FHR:** `Mix-HP-AL`ì€ **11.90%**ë¡œ ëª¨ë“  ëª¨ë¸ ì¤‘ ê°€ì¥ ë‚®ì€ ìˆ˜ì¹˜ë¥¼ ê¸°ë¡í–ˆë‹¤. ê³„ì¸µì  í˜ë„í‹°ì™€ Adaptive ê°€ì¤‘ì¹˜ì˜ ì‹œë„ˆì§€ê°€ ë¶ˆí•„ìš”í•œ ì°¨ì´í•­($\gamma$)ì„ ê°•ë ¥í•˜ê²Œ ì¶•ì†Œì‹œì¼°ìŒì„ ì˜ë¯¸í•œë‹¤.
        
    - **FPR/TPR:** `Mix-HP-L`ê³¼ ë¹„êµí•´ False Positive Rate(FPR)ëŠ” ë‚®ì¶”ê³ (50.2% $\rightarrow$ 44.47%), True Positive Rate(TPR)ëŠ” ìµœê³  ìˆ˜ì¤€(97.0%)ì„ ìœ ì§€í–ˆë‹¤. (MSE ì¸¡ë©´ì—ì„œëŠ” `Mix-HP-L`ì´ 0.0226ìœ¼ë¡œ ë¯¸ì„¸í•˜ê²Œ ë” ë‚®ì•˜ìœ¼ë‚˜, ë‘ ëª¨ë¸ ëª¨ë‘ ê¸°ì¡´ ëª¨ë¸ ëŒ€ë¹„ í›Œë¥­í•œ ì¶”ì • ì„±ëŠ¥ì„ í™•ë³´í•¨).
            

## 5. ê²°ë¡  (Conclusion)
Pilot Estimatorë¥¼ ê³„ì¸µì  êµ¬ì¡°(Mix-HP-L)ë¡œ ì¼ì¹˜ì‹œí‚¨ ì•Œê³ ë¦¬ì¦˜ ìˆ˜ì •ì€ ë§¤ìš° ì„±ê³µì ì´ì—ˆë‹¤. `Mix-HP-AL`ì€ ê³„ì¸µì  êµ¬ì¡°ì˜ í¬ì†Œì„±(Low FHR)ì„ ê°€ì¥ ì •í™•í•˜ê²Œ íŒŒì•…í•´ë‚´ë©°, ìµœì ì˜ BIC ì§€ìˆ˜ì™€ ë¹ ë¥¸ ìˆ˜ë ´ ì†ë„ë¥¼ ë³´ì—¬ì£¼ì—ˆë‹¤. ì´ëŠ” Adaptive ê°€ì¤‘ì¹˜ ì‚°ì¶œ ë°©ì‹ì˜ êµ¬ì¡°ì  ê²°í•¨ì„ ë°”ë¡œì¡ìŒìœ¼ë¡œì¨, **ì •ë°€í•œ ë³€ìˆ˜ ì„ íƒê³¼ ì•ˆì •ì ì¸ ëª¨ë¸ íŒŒì•…**ì´ë¼ëŠ” ë‘ ê°€ì§€ ëª©í‘œë¥¼ ë™ì‹œì— ë‹¬ì„±í•œ ê²°ê³¼ì´ë‹¤.


## 6. Appendix
### 1. ì•Œê³ ë¦¬ì¦˜ ìˆ˜ì • (Methodology Correction)

**í•µì‹¬ ë³€ê²½ ì‚¬í•­:**

1. **Pilot Estimator:** Adaptive Weightë¥¼ ê³„ì‚°í•  ë•Œ, ì¼ë°˜ Mix-Lassoê°€ ì•„ë‹Œ **HP êµ¬ì¡°ê°€ ë°˜ì˜ëœ Mix-HP-L(Adaptive=False)**ì„ ì¬ê·€ì ìœ¼ë¡œ í˜¸ì¶œí•˜ì—¬ ì‚¬ìš©.
    
2. **Warm Start:** Pilot ë‹¨ê³„ì—ì„œ ì°¾ì€ ìµœì í•´($\beta_0, B$)ë¥¼ ë³¸ í•™ìŠµì˜ ì´ˆê¸°ê°’ìœ¼ë¡œ ìŠ¹ê³„í•˜ì—¬ Local Optima ë°©ì§€.
    

Python

```
def fit_mix_HP_L_or_AL(y, X, m, lam, adaptive=False, gamma=1.0,
                       pilot_em=15, w_eps=1e-4, w_min=1e-2, w_max=1e4,
                       max_em=50, tol_em=1e-4,
                       max_cd=400, tol_cd=1e-6, min_cd=5,
                       rebuild_every=10,
                       n_start=3, seed_base=1,
                       min_pi=1e-6, rho_floor=1e-8,
                       verbose=False, trace_em_every=10, trace_tag="EM-HP"):
    n, p = X.shape
    best = None
    best_obj = -np.inf
    pilot_ridge_scale = 1e-3

    for s in range(1, n_start+1):
        # ... (ì´ˆê¸°í™” ë° Random Start ì½”ë“œ ìƒëµ: ê¸°ì¡´ê³¼ ë™ì¼) ...
        np.random.seed(safe_seed(seed_base + 2000*s + 23*m))
        z = np.random.randint(0, m, size=n)
        tau = np.zeros((n, m), dtype=np.float64)
        tau[np.arange(n), z] = 1.0
        
        ini = init_from_tau(y, X, tau, ridge_scale=pilot_ridge_scale, rho_floor=rho_floor, min_pi=min_pi)
        pi = ini["pi"]
        rho = ini["rho"]
        beta_tilde_init = ini["beta_tilde"]

        beta0 = np.mean(beta_tilde_init, axis=1)
        Bfull = beta_tilde_init - beta0[:, None]
        Bfree = Bfull[:, :m-1].copy()

        # -------------------------------------------------------------------------
        # [ìˆ˜ì •ëœ ë¶€ë¶„] Adaptive Lassoë¥¼ ìœ„í•œ Pilot Estimator êµ¬ì¡°ì  ì¼ì¹˜í™”
        # -------------------------------------------------------------------------
        pen_w0 = np.ones(p, dtype=np.float64)
        pen_wB = np.ones((p, m), dtype=np.float64)

        if adaptive:
            # 1. Pilot ì¶”ì •: ìê¸° ìì‹ ì„ ì¬ê·€ í˜¸ì¶œí•˜ë˜ adaptive=Falseë¡œ ì„¤ì • (Mix-HP-L)
            #    ëª©ì : ê³„ì¸µì  êµ¬ì¡°(Hierarchical Structure)ê°€ ë°˜ì˜ëœ ì •í™•í•œ ê°€ì¤‘ì¹˜ ì‚°ì¶œ
            lam_max_pilot = lambda_grid(y, X, m, lam_ratio=1e-4)[0]
            pilot_lam = 0.2 * lam_max_pilot
            
            pil_fit = fit_mix_HP_L_or_AL(
                y, X, m, pilot_lam,
                adaptive=False,     # <--- í•µì‹¬: HP êµ¬ì¡°ë§Œ ì ìš© (Adaptive X)
                n_start=1,          # Pilotì€ í•œ ë²ˆë§Œ ìˆ˜í–‰í•´ë„ ì¶©ë¶„
                max_em=pilot_em,
                tol_em=tol_em,
                pilot_em=pilot_em,
                seed_base=seed_base + 100000 + s,
                max_cd=max_cd, tol_cd=tol_cd, min_cd=min_cd, rebuild_every=rebuild_every
            )

            if pil_fit is not None:
                beta0_est = pil_fit["beta0"]
                Bfull_est = Bfree_to_Bfull(pil_fit["Bfree"])
                
                # 2. ê°€ì¤‘ì¹˜ ê³„ì‚° (Pilotì˜ ì—­ìˆ˜)
                pen_w0 = make_adaptive_weights(beta0_est, gamma=1.0, eps=1e-4).astype(np.float64)
                pen_wB = make_adaptive_weights(Bfull_est, gamma=1.0, eps=1e-4).astype(np.float64)
                
                # ì •ê·œí™” (Normalization)
                pen_w0 = pen_w0 / (np.mean(pen_w0) + 1e-12)
                pen_wB = pen_wB / (np.mean(pen_wB) + 1e-12)

                # 3. Warm Start: Pilotì˜ í•´ë¥¼ ë³¸ í•™ìŠµì˜ ì´ˆê¸°ê°’ìœ¼ë¡œ ì‚¬ìš© (Local Optima ë°©ì§€)
                beta0 = beta0_est.copy()
                Bfree = Bfull_est[:, :m-1].copy()
        # -------------------------------------------------------------------------

        # ... (ì´í›„ EM ì•Œê³ ë¦¬ì¦˜ ìˆ˜í–‰ ë° M-Step: ê¸°ì¡´ê³¼ ë™ì¼) ...
        
        # (ì¤‘ëµ: EM Loop)

    return best
```

---

### 2. ì‹œë®¬ë ˆì´ì…˜ ì„¤ì • (Simulation Settings)

**íŠ¹ì´ì‚¬í•­:** ì•ˆì •ì ì¸ ìˆ˜ë ´ê³¼ ë¹„êµë¥¼ ìœ„í•´ ë°˜ë³µ íšŸìˆ˜($R=30$) ë° ì´ˆê¸°ê°’ íƒìƒ‰(`n_start=8`)ì„ í™•ì¥í•œ Robust Setting ì ìš©.

Python

```{python}
CFG = dict(
    R = 30,             # ë°˜ë³µ íšŸìˆ˜
    n = 200,            # ìƒ˜í”Œ ìˆ˜
    p = 60,             # ë³€ìˆ˜ ìˆ˜
    snr = 50,           # ì‹ í˜¸ ëŒ€ ì¡ìŒë¹„
    m_set = [2, 3],     # ì§‘ë‹¨ ìˆ˜ íƒìƒ‰ ë²”ìœ„
    
    # ìµœì í™” íŒŒë¼ë¯¸í„° 
    nlambda = 16,
    lam_ratio = 1e-4,
    
    # EM ì•Œê³ ë¦¬ì¦˜ ì„¤ì • (ì¶©ë¶„í•œ íƒìƒ‰ ë³´ì¥)
    pilot_em = 50,      # Pilot ë°˜ë³µ íšŸìˆ˜
    n_start = 8,        # ì´ˆê¸°ê°’ ì‹œë„ íšŸìˆ˜
    max_em = 150,
    tol_em = 1e-4,
    max_cd = 600,
    tol_cd = 1e-6,
    min_cd = 10,
    rebuild_every = 5
)
```

---

### 3. ì‹¤í—˜ ê²°ê³¼ (Results)

**ê²°ê³¼ í•´ì„:**
    
- **MSE:** 0.022625, 0.035754ë¡œ ë‚®ìŒ.
    
- **FHR:** 11.9%ë¡œ ë§¤ìš° ë‚®ìŒ (êµ¬ì¡° ì‹ë³„ ëŠ¥ë ¥ 1ìœ„).
    


```
method      MSE_b      MSE_s2    MSE_pi        FPR        FHR        TPR \
3      Mix-L  0.125200  46.424843  0.071868  31.400000  64.761905  62.000000   
0     Mix-AL  0.286668   0.760061  0.016390  80.466667  96.190476  96.000000   
2   Mix-HP-L  0.022625   1.151815  0.006657  50.200000  17.619048  96.333333   
1  Mix-HP-AL  0.035754   0.268271  0.022817  44.466667  11.904762  97.000000   

      ll_mean    bic_mean  em_iter_mean  chosen_m_mode  
3 -301.887673  879.111239    118.166667              2  
0  -33.553377  835.362772    136.933333              3  
2 -241.822902  766.575952    149.633333              3  
1 -240.746873  743.583845    109.666667              3
```
